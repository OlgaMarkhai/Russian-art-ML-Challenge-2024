# Russian-art-ML-Challenge-2024
Алгоритм распознавания типов произведений народного искусства
# Задача  
Задача направлена на создание ИИ, способного определять жанр произведения искусства на основе его внешнего вида. Внешний вид художественного произведения представлен фотографиями, тщательно распределенными по категориям.  

В качестве решения ожидается, что вы предоставите алгоритм, который на основе изображения произведения искусства может предсказать его категорию. Метка считается правильно определенной только в том случае, если и категория верхнего уровня, и подкатегория предсказаны верно. Прогнозы должны быть качественными, и качество будет измеряться с использованием метрики, описанной ниже. Победители конкурса будут определены на основе метрики их моделей.  


# Данные  
Данные, представленные в конкурсе, имеют иерархическую структуру. Существует 5 категорий высшего уровня:
* Архитектура
* Графика
*  Декоративное и прикладное искусство
* Живопись
* Скульптуры

Каждая из этих категорий верхнего уровня имеет переменное количество подкатегорий. Например, категория «Живопись» содержит 11 жанров, которые называются батальными, анималистическими, абстрактными и т. д.

# Загрузка данных    
1. Скачайте файл train.zip по ссылке https://storage.yandexcloud.net/contestfiles/A_RUS_ART/train.zip  
2. Разархивируйте содержимое архива в новую папку   
3. Скачайте train.csv и положите его в ту же папку

# Решение 
**Выбранная модель:** Применяется архитектура модели convnext_base из библиотеки timm. Это современная модель сверточной нейронной сети, предобученная на большом наборе данных.  

**Модификация модели:** Заменен последний полносвязный слой (fc) оригинальной модели на новый слой с числом выходов, равным количеству классов в задаче (num_classes=35). Это необходимо, так как количество классов в вашем наборе данных скорее всего отличается от количества классов, на которых была предобучена исходная модель.  

**Предобработка данных:** Изображения преобразуются к единому размеру 260x260 пикселей, случайно отражаются по горизонтали для аугментации данных, преобразуются в тензоры и нормализуются с использованием заданных средних значений и стандартных отклонений.  

**Подготовка датасета:** Создается пользовательский класс ArtDataset, который загружает изображения и соответствующие метки из указанной директории и файла CSV. Этот класс используется для создания объектов trainset и testset с помощью функции train_test_split, которая разделяет данные на обучающую и тестовую выборки.  

**Загрузка данных:** Используется DataLoader для эффективной загрузки данных во время обучения модели, с указанием размера батча и числа параллельных загрузчиков (num_workers).  

**Настройка устройства для обучения:** Определяется, доступна ли CUDA (GPU), и соответственно настраивается устройство для обучения (device).  

**Оптимизаторы:** Используется два разных оптимизатора:
- AdamW для первоначального обучения только последнего слоя
- SGD для полного обучения всей модели после первоначальной настройки

**Функция потерь:** Используется кросс-энтропийная функция потерь (CrossEntropyLoss), подходящая для задач классификации.  

**Процесс обучения:** Модель обучается в два этапа:  
- предобучение только последнего слоя на несколько эпох  
- полное обучение всей модели на большее количество эпох  

Во время обучения ведется отслеживание потерь и метрики F1 для обучающей и валидационной выборок, лучшая метрика - **0.79445010905683**  

**Сохранение модели:** Лучшая модель (согласно метрике F1 на валидационной выборке) сохраняется для дальнейшего использования.
